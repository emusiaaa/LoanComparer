@model OfferModel
<script>
    function downloadAgreement() {
        let text = "@ViewBag.document";
        var filename = "Agreement.txt";
        var element = document.createElement('a');
        element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element.setAttribute('download', filename);
        element.style.display = 'none';
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
    }
</script>
<h1>Twoja oferta</h1>
<input type="button" id="dwn-btn" value="Download Agreement" onclick="downloadAgreement()" />
<h1>@Model.CreateDate</h1>
<h1>@Model.DocumentLink</h1>
<h1>@Model.OfferIdInBank</h1>
<div>
    <form enctype="multipart/form-data" onsubmit="AJAXSubmit(this);return false;"
    method="post">
        <input type="file" name="formFile" required/>
        <input class="btn btn-outline-primary" type="submit"/>
    </form>
    <div style="margin-top:15px">
        <output name="result"></output>
    </div>
    <a idasp-controller="Home" asp-action="AcceptOffer" asp-route-offerID="@Model.Id">Accept Offer</a>
</div>

<script>
    async function AJAXSubmit(oFormElement) {
        var resultElement = oFormElement.elements.namedItem("result");
        const formData = new FormData(oFormElement);

        try {
            const response = await fetch('SendFile/' + @Model.Id + '/' + @Model.OfferIdInBank, {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                window.location.href = 'AcceptOffer/' + @Model.Id;
                //document.getElementById("ahref").click();
            }
        } catch (error) {
            console.error('Error:', error);
        }
    }
</script>
